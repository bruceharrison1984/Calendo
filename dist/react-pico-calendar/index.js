var e;import t,{createContext as n,useCallback as a,useState as r,useEffect as o,useMemo as l,useContext as i,useRef as d}from"react";import s from"@swc/helpers/src/_object_spread.mjs";let c=n(null);c.displayName="ActionContext";let m=({children:e,actions:t})=>{let n=(null==t?void 0:t.onEventClick)?null==t?void 0:t.onEventClick:e=>console.log(e),r=(null==t?void 0:t.onMoreEventClick)?null==t?void 0:t.onMoreEventClick:e=>console.log(e),o=(null==t?void 0:t.onMonthChangeClick)?null==t?void 0:t.onMonthChangeClick:(e,t)=>console.log({firstOfMonth:e,lastOfMonth:t}),l=a(n,[n]),i=a(r,[r]),d=a(o,[o]);return React.createElement(c.Provider,{value:{onEventClick:l,onMoreEventClick:i,onMonthChangeClick:d}},e)};!function(e){e[e.tiny=0]="tiny",e[e.medium=1]="medium",e[e.large=2]="large"}(e||(e={}));let u=()=>{let[t,n]=r(e.large),l=a((e,a)=>{window.matchMedia(e).matches&&t!==a&&n(a);let r=()=>n(a);return window.addEventListener("resize",r),r},[n,t]);return o(()=>{let t=l("(max-width: 480px)",e.tiny),n=l("(max-width: 768px) and (min-width: 481px)",e.medium),a=l("(min-width: 769px)",e.large);return()=>{window.removeEventListener("resize",t),window.removeEventListener("resize",n),window.removeEventListener("resize",a)}},[l]),t},h=n(null);h.displayName="CalendarContext";let v=({dateAdapter:e,initialDate:t,calendarEvents:n,rootDiv:i,children:d})=>{var s;let[c,m]=r(e.convertIsoToDate(t)),[v,g]=r(null==i?void 0:null===(s=i.current)||void 0===s?void 0:s.getBoundingClientRect()),[y,E]=r(),p=u(),C=l(()=>e.getDaysOfWeek(p),[p,e]),w=l(()=>e.getCalendarView(c),[c,e]);o(()=>{if(null==i?void 0:i.current){var e;let t=null==i?void 0:null===(e=i.current)||void 0===e?void 0:e.getBoundingClientRect();g(t),E(t.height/w.length),console.log(t.height/w.length),console.log(t.height)}},[g,i,w]);let M=l(()=>n.map(t=>({start:e.convertIsoToDate(t.start),end:e.convertIsoToDate(t.end),color:t.color,id:t.id,summary:t.summary})).filter(t=>e.isSameMonth(t.start,c)||e.isSameMonth(t.end,c)),[c,n,e]),k=l(()=>w.map(t=>({weekStart:t[0],weekEnd:t[6],daysInWeek:t,events:M.filter(n=>e.isEventInWeek(n.start,n.end,t)),eventsOnDays:t.map(e=>({date:e,events:M.filter(t=>t.start<=e&&t.end>=e)}))})),[w,M,e]),D=a(()=>m(t=>e.addMonthsToDate(t,1)),[e]),R=a(()=>m(t=>e.addMonthsToDate(t,12)),[e]),f=a(()=>m(t=>e.addMonthsToDate(t,-1)),[e]),N=a(()=>m(t=>e.addMonthsToDate(t,-12)),[e]);return React.createElement(h.Provider,{value:{currentMonth:c,dateAdapter:e,daysOfWeek:C,onNextMonth:D,onNextYear:R,onPrevMonth:f,onPrevYear:N,calendarWithEvents:k,calendarBoundingBox:v,dayHeightPx:y}},d)},g=({isCurrentMonth:e,isToday:t,dateNumber:n,events:a,isOverflowed:r,onClick:o})=>{let l=t?React.createElement("div",{className:"default-day-header--indicator"},React.createElement("span",{className:"default-day-header--text"},n)):React.createElement("span",{className:"default-day-header--text"},n);return React.createElement("div",{className:`default-day ${e?"default-day-current":"default-day-sibling"}`},React.createElement("div",{className:"default-day-header"},l),r&&React.createElement("div",{className:"additional-events-indicator",title:`(${a.length}) total events`,onClick:()=>o(a)},"..."))},y=({event:e,isHovered:t,onClick:n})=>React.createElement("div",{className:`event ${t?"event-selected":"event-unselected"}`,style:{backgroundColor:e.color},title:e.summary,onClick:()=>n(e)},e.summary),E=({month:e,year:t,onNextMonth:n,onNextYear:a,onPrevMonth:r,onPrevYear:o,isCurrentMonth:l})=>React.createElement("div",{className:"header-layout"},React.createElement("button",{className:"header-button",title:"Previous Month",onClick:r},React.createElement("strong",null,"‹")),React.createElement("button",{className:"header-button",title:"Previous Year",onClick:o},React.createElement("strong",null,"\xab")),React.createElement("div",{className:"header-banner"},React.createElement("h2",{style:{display:"inline-block"}},e," - ",t,l&&React.createElement("div",{className:"current-month-indicator",title:"Current Month"}))),React.createElement("button",{className:"header-button",title:"Next Year",onClick:a},React.createElement("strong",null,"\xbb")),React.createElement("button",{className:"header-button",title:"Next Month",onClick:n},React.createElement("strong",null,"›"))),p=n(null);p.displayName="ComponentContext";let C=({calendarComponents:e,children:n})=>{let a=e?s({},w,e):w,r={dayComponent:t.memo(a.dayComponent),headerComponent:t.memo(a.headerComponent),eventComponent:t.memo(a.eventComponent)};return t.createElement(p.Provider,{value:r},n)},w={dayComponent:g,headerComponent:E,eventComponent:y},M=n(null);M.displayName="HighlightContext";let k=({children:e})=>{let[t,n]=r(void 0),o=a(e=>t===e,[t]);return React.createElement(M.Provider,{value:{setHighlight:e=>n(e),clearHighlight:()=>n(void 0),isHighlighted:o}},e)},D=()=>{let e=i(h);if(!e)throw Error("useCalendar must be used within CalendarProvider");return e},R=()=>{let{daysOfWeek:e}=D();return React.createElement("div",{className:"day-of-week-layout"},e.map((e,t)=>React.createElement("div",{key:`${e}-${t}`},React.createElement("div",{className:"default-day-of-week"},e))))},f=()=>{let e=i(M);if(!e)throw Error("useHighlight must be used within HighlightProvider");return e},N=({root:e,rootMargin:t="0px 0px -1% 0px",threshold:n=1})=>{let a=d(null),[l,i]=r(!1),s=e=>e.map(e=>e.intersectionRatio<1&&i(!0));return o(()=>{let r=a.current,o=new IntersectionObserver(s,{root:e.current,rootMargin:t,threshold:n});return r&&o.observe(r),()=>{r&&o.unobserve(r)}}),{eventContainerRef:a,isOverlapping:l}},x=({event:e,startIndex:t,endIndex:n,children:a,parentContainerRef:r})=>{let{setHighlight:o,clearHighlight:l}=f(),{eventContainerRef:i,isOverlapping:d}=N({root:r});return React.createElement("div",{className:"event-position-layout","data-eventid":e.id,style:{gridColumnStart:t,gridColumnEnd:n,display:d?"none":void 0},onMouseOver:()=>o(e.id),onMouseLeave:l,ref:i},a)},b=()=>{let e=i(c);if(!e)throw Error("useActions must be used within ActionProvider");return e},I=()=>{let e=i(p);if(!e)throw Error("useComponents must be used within ComponentProvider");return e},P=({events:e,daysInweek:t})=>{let{dateAdapter:{getGridStartIndex:n,getGridEndIndex:a}}=D(),{eventComponent:r}=I(),{isHighlighted:o}=f(),{onEventClick:l}=b(),i=d(null),{dayHeightPx:s}=D();return React.createElement("div",{ref:i,className:"event-week-layout",style:{height:s}},React.createElement("div",{style:{gridColumnStart:1,gridColumnEnd:8}}),i&&e.map(e=>React.createElement(x,{key:e.id,event:e,startIndex:n(e.start,t[0]),endIndex:a(e.end,t[6]),parentContainerRef:i},React.createElement(r,{event:e,isHovered:o(e.id),onClick:l}))))},Y=()=>{let{onNextMonth:e,onNextYear:t,onPrevMonth:n,onPrevYear:r}=D(),l=a(e=>{"ArrowLeft"===e.key&&n()},[n]),i=a(e=>{"ArrowDown"===e.key&&r()},[r]),d=a(t=>{"ArrowRight"===t.key&&e()},[e]),s=a(e=>{"ArrowUp"===e.key&&t()},[t]);o(()=>{document.addEventListener("keydown",l),document.addEventListener("keydown",i),document.addEventListener("keydown",d),document.addEventListener("keydown",s)},[l,d,i,s])},A=()=>{let{currentMonth:e,onNextMonth:t,onNextYear:n,onPrevYear:a,onPrevMonth:r,dateAdapter:{getMonthName:l,getYear:i,isCurrentMonth:d}}=D(),{onMonthChangeClick:s}=b(),{headerComponent:c}=I();return o(()=>{let t=new Date(e.getFullYear(),e.getMonth(),1),n=new Date(t.getFullYear(),t.getMonth()+1,1,0,0,-1);s(t,n)},[e,s]),Y(),React.createElement(c,{isCurrentMonth:d(e),month:l(e),year:i(e),onNextMonth:t,onNextYear:n,onPrevMonth:r,onPrevYear:a})},O=({dates:e,eventsOnDays:t})=>{let{dateAdapter:n,currentMonth:r,dayHeightPx:o}=D(),{dayComponent:l}=I(),{onMoreEventClick:i}=b(),d=a((e,n=3)=>{var a;let r=null===(a=t.find(t=>t.date===e))||void 0===a?void 0:a.events;return!!r&&r.length>n},[t]);return React.createElement("div",{className:"week-layout",style:{height:o}},e.map(e=>{var a;return React.createElement("div",{key:e.getDate(),"data-day":e.getDate(),"data-istoday":!!n.isDateToday(e)||void 0},React.createElement(l,{isCurrentMonth:n.isSameMonth(e,r),isToday:n.isDateToday(e),dateNumber:n.getDayNumber(e),isOverflowed:d(e),events:(null===(a=t.find(t=>t.date===e))||void 0===a?void 0:a.events)||[],onClick:i}))}))},T=()=>{let{calendarWithEvents:e}=D();return React.createElement(k,null,e.map((e,t)=>React.createElement("div",{key:t,className:"week-container","data-week":t},!!e.events.length&&React.createElement(P,{events:e.events,daysInweek:e.daysInWeek}),React.createElement(O,{eventsOnDays:e.eventsOnDays,dates:e.daysInWeek}))))},H=(t="en")=>{let n=new Map([[e.large,"long"],[e.medium,"short"],[e.tiny,"narrow"]]),a=e=>e.getFullYear(),r=(e,t)=>a(e)===a(t)&&e.getMonth()===t.getMonth(),o=e=>{let t=new Date;return r(e,t)&&e.getDate()===t.getDate()};return{getCalendarView(e){let t=new Date(e.getFullYear(),e.getMonth(),1),n=new Date(e.getFullYear(),e.getMonth()+1,0),a=[],r=[],o=[],l=t;for(;0!==l.getDay();)a.push(l=new Date(l.getFullYear(),l.getMonth(),l.getDate()-1));for(l=t;l.getMonth()===t.getMonth();)r.push(l),l=new Date(l.getFullYear(),l.getMonth(),l.getDate()+1);for(l=n;l.getDay()+1!==7;)o.push(l=new Date(l.getFullYear(),l.getMonth(),l.getDate()+1));let i=[...a.reverse(),...r,...o];return[...Array(Math.ceil(i.length/7))].map(()=>i.splice(0,7))},getDaysOfWeek(e){let a=new Intl.DateTimeFormat(t,{weekday:n.get(e)});return[0,1,2,3,4,5,6].map(e=>a.format(new Date(2012,0,e+1)))},getMonthName:e=>new Intl.DateTimeFormat(t,{month:"long"}).format(e),getYear:a,getDayNumber:e=>e.getDate(),isSameMonth:r,isDateToday:o,addMonthsToDate:(e,t)=>new Date(e.getFullYear(),e.getMonth()+t,1),getGridEndIndex:(e,t)=>e>t?8:e.getDay()+2,getGridStartIndex:(e,t)=>e<=t?1:e.getDay()+1,isEventInWeek(e,t,n){if(7!==n.length)throw Error("Week length must be 7");let a=e>=n[0]&&e<=n[6],r=t>=n[0]&&t<=n[6];return e<=n[0]&&t>=n[6]||a||r},convertIsoToDate:e=>new Date(e),isCurrentMonth:()=>!0}},S=({dateAdapter:e=H(),schedulelyComponents:t,events:n,theme:a,additionalClassNames:r=[],actions:o,dark:l,initialDate:i=new Date().toISOString()})=>{if(!e)throw Error("Date Adapter must be supplied!");let s=d(null);return React.createElement("div",{id:"schedulely",className:[...r,"schedulely"].join(" "),"data-theme":a,"data-dark":l?"":void 0},React.createElement(m,{actions:o},React.createElement(C,{calendarComponents:t},React.createElement(v,{initialDate:i,dateAdapter:e,calendarEvents:n,rootDiv:s},React.createElement(A,null),React.createElement(R,null),React.createElement("div",{ref:s},React.createElement(T,null))))))};export{e as DisplaySize,S as Schedulely,H as createDefaultAdapter};
